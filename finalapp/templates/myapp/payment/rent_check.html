{% extends 'baseuser.html' %}
{% load static %}
{% load humanize %}
{% block content %}

<head>
    <title>‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢‡∏£‡∏≤‡∏¢‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</title>
    <link rel="stylesheet" href="{% static 'css/rent_check.css' %}">
</head>

<body>
    <div class="rent-check-container">
        <h2>üí∞ ‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢‡∏£‡∏≤‡∏¢‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</h2>

        {% if room_not_found %}
            <p class="error-message">‚ö†Ô∏è ‡∏Ñ‡∏∏‡∏ì‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏´‡πâ‡∏≠‡∏á‡∏û‡∏±‡∏Å‡∏ó‡∏µ‡πà‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô ‚ö†Ô∏è</p>
        {% else %}
            <div class="room-details">
                <h3>üè† ‡∏´‡πâ‡∏≠‡∏á‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì : <strong>{{ user_room.room_number }} ({{ user_room.room_type }})</strong></h3>

                <!-- ‚úÖ ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏î‡∏∑‡∏≠‡∏ô -->
                <form method="GET" action="">
                    <label for="month">üìÖ ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô :</label>
                    <select name="month" id="month" onchange="this.form.submit()">
                        {% for month in available_months %}
                            <option value="{{ month }}" {% if month == selected_month %}selected{% endif %}>
                                {{ month }}
                            </option>
                        {% endfor %}
                    </select>
                </form>

                {% if selected_usage %}
                    <div class="cost-summary">
                        <div class="cost-item rent">
                            <p>üí∞ ‡∏Ñ‡πà‡∏≤‡πÄ‡∏ä‡πà‡∏≤ :</p>
                            <strong>{{ rent_price|floatformat:0|intcomma }} ‡∏ö‡∏≤‡∏ó</strong>
                        </div>
                        <div class="cost-item electricity">
                            <p>‚ö° ‡∏Ñ‡πà‡∏≤‡πÑ‡∏ü :</p>
                            <strong>{{ selected_usage.consumption|floatformat:0|intcomma }} ‡∏´‡∏ô‡πà‡∏ß‡∏¢</strong> √ó 
                            <strong>{{ user_room.electricity_price|floatformat:0|intcomma }} ‡∏ö‡∏≤‡∏ó/‡∏´‡∏ô‡πà‡∏ß‡∏¢</strong> =
                            <strong>{{ electricity_cost|floatformat:0|intcomma }} ‡∏ö‡∏≤‡∏ó</strong>
                        </div>
                        <div class="cost-item water">
                            <p>üíß ‡∏Ñ‡πà‡∏≤‡∏ô‡πâ‡∏≥ :</p>
                            <strong>{{ water_price|floatformat:0|intcomma }} ‡∏ö‡∏≤‡∏ó</strong>
                        </div>
                        <div class="cost-item total">
                            <h3>üíµ ‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î :</h3>
                            <span class="total-cost">{{ total_cost|floatformat:0|intcomma }} ‡∏ö‡∏≤‡∏ó/‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</span>
                        </div>
                    </div>

                    <!-- ‚úÖ ‡πÅ‡∏™‡∏î‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô -->
                    <div class="payment-status">
                        {% if payment %}
                            {% if payment.status == "approved" %}
                                <p class="success-message">‚úÖ ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞: <strong>‡∏ä‡∏≥‡∏£‡∏∞‡πÅ‡∏•‡πâ‡∏ß</strong></p>

                                {% if payment.slip %}
                                    <div class="slip-container">
                                        <h3>üìÑ ‡∏´‡∏•‡∏±‡∏Å‡∏ê‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô</h3>
                                        <img src="{{ payment.slip.url }}" alt="‡∏™‡∏•‡∏¥‡∏õ‡∏Å‡∏≤‡∏£‡πÇ‡∏≠‡∏ô‡πÄ‡∏á‡∏¥‡∏ô" class="payment-slip">
                                    </div>
                                {% endif %}
                                
                            {% elif payment.status == "pending" %}
                                <p class="warning-message">‚åõ ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞: <strong>‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö</strong></p>
                            {% elif payment.status == "rejected" %}
                                <p class="error-message">‚ùå ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞: <strong>‡πÑ‡∏°‡πà‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥</strong></p>
                            {% else %}
                                <p class="error-message">‚ùå ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞: <strong>‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏ä‡∏≥‡∏£‡∏∞</strong></p>
                            {% endif %}
                        {% else %}
                            <p class="error-message">‚ùå ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞: <strong>‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏ä‡∏≥‡∏£‡∏∞</strong></p>
                        {% endif %}
                    </div>
                {% else %}
                    <p class="warning-message">‚ö†Ô∏è ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ñ‡πà‡∏≤‡πÑ‡∏ü‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏ô‡∏µ‡πâ ‚ö†Ô∏è</p>
                {% endif %}
            </div>
        {% endif %}
        
        <div class="button-container">
            {% if not payment or payment.status != "approved" %}
                <a href="{% url 'payment' %}?month={{ selected_month }}" class="btn btn-pay">üí∏ ‡πÅ‡∏à‡πâ‡∏á‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô</a>
            {% endif %}
        </div>
        
    </div>
</body>

{% endblock %}
